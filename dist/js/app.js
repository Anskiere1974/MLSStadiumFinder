function mapError(){alert("Sorry we have a problem loading the Google Map. Drink a cup of coffee and retry later.")}var Teams=function(e){this.name=e.name,this.stadium=e.stadium,this.capacity=e.capacity,this.lat=e.lat,this.lng=e.lng,this.conference=e.conference,this.visible=!0,this.address=e.address},AppViewModel=function(){var e=this;this.query=ko.observable(""),this.teamList=ko.observableArray([]),this.liveSearch=function(t){e.teamList().forEach(function(t){t.name.toLowerCase().indexOf(e.query().toLowerCase())>=0?(t.visible=!0,t.marker.setVisible(!0)):(t.visible=!1,t.marker.setVisible(!1))})},this.createTeamList=function(){for(var t=0;t<teamData.length;t++)e.teamList.push(new Teams(teamData[t]))},this.filter=function(t){for(var a=0;a<teamData.length;a++)teamData[a].conference===t&&e.teamList.push(new Teams(teamData[a]));e.createMarker()},this.filterWest=function(){e.removeMarker(),e.teamList.removeAll(),e.query(""),e.filter("west")},this.filterEast=function(){e.removeMarker(),e.teamList.removeAll(),e.query(""),e.filter("east")},this.filterAll=function(){e.removeMarker(),e.teamList.removeAll(),e.query(""),e.createTeamList(),e.createMarker()},this.createMarker=function(){for(var t=0;t<e.teamList().length;t++){var a=e.teamList()[t].name,i="images/"+(a=(a=(a=a.toLowerCase()).replace(/\./g,"")).replace(/ /g,""))+".png",r=new google.maps.Marker({map:e.map,icon:{url:i,size:new google.maps.Size(32,32),anchor:new google.maps.Point(16,32)},position:{lat:e.teamList()[t].lat,lng:e.teamList()[t].lng},title:e.teamList()[t].name,stadium:e.teamList()[t].stadium,capacity:e.teamList()[t].capacity,animation:google.maps.Animation.DROP,address:teamData[t].address});r.addListener("click",e.markerClick),e.teamList()[t].marker=r}},this.markerClick=function(){e.letsBounce(this),e.getGeocodeAddress(this)},this.removeMarker=function(){e.teamList().forEach(function(e){e.marker.setMap(null)})},this.letsBounce=function(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1400)},this.handleMarker=function(){e.letsBounce(this.marker),e.getGeocodeAddress(this.marker),e.map.setCenter(this.marker.getPosition())},this.populateInfoWindow=function(e,t){t.marker!=e&&(t.marker=e,t.setContent('<div class="marker-title">'+e.title+'</div><img src="https://maps.googleapis.com/maps/api/staticmap?center='+e.position.lat()+","+e.position.lng()+'&zoom=16&size=200x200&maptype=hybrid&key=AIzaSyCKRKYTqc_igfzoYRi0-fgyKDm21AVU_yU" alt="" /><div>'+e.stadium+"</div><div>"+e.address+"</div><div>capacity: "+e.capacity+"</div><div>weather: "+e.weather+"</div><div>temperature: "+e.temp+"Celsius</div>"),t.open(map,e),t.addListener("closeclick",function(){t.setMarker=null}))},this.getGeocodeAddress=function(t){var a=t.position.lat(),i=t.position.lng();$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?latlng="+a+","+i+"&key=AIzaSyCKRKYTqc_igfzoYRi0-fgyKDm21AVU_yU",success:function(a){var i=a.results[0].formatted_address;t.address=i,e.getWeather(t)},error:function(){alert("Unable to reach GoogleMap Geocoding - please try again later")}})},this.getWeather=function(t){var a=t.position.lat(),i=t.position.lng();$.ajax({url:"http://api.openweathermap.org/data/2.5/weather?lat="+a+"&lon="+i+"&APPID=906ae1bd2537be3aefb269cb9a2f068a&units=metric",success:function(a){null!==a.main.temp||void 0!==a.main.temp||""!==a.main.temp?t.temp=a.main.temp:t.temp="currently unavailable",null!==a.weather[0].description||void 0!==a.weather[0].description||""!==a.weather[0].description?t.weather=a.weather[0].description:t.weather="currently unavailable",e.populateInfoWindow(t,e.infowindow)},error:function(){alert("Unable to reach Openweathermap.org - please try again later")}})},this.initMap=function(){var t={center:{lat:37.8,lng:-101.5},zoom:5,mapTypeControl:!1,streetViewControl:!1,zoomControl:!1,fullscreenControl:!1,styles:mapStyle};e.map=new google.maps.Map(document.getElementById("map"),t),e.infowindow=new google.maps.InfoWindow},this.initMap(),this.createTeamList(),this.createMarker()},init=function(){ko.applyBindings(new AppViewModel)};$(document).ready(function(){$("#sidebar-btn").on("click",function(){$("#sidebar").toggleClass("visible")})});