var Teams=function(e){this.name=ko.observable(e.name),this.stadium=ko.observable(e.stadium),this.capacity=ko.observable(e.capacity),this.lat=ko.observable(e.lat),this.lng=ko.observable(e.lng),this.conference=ko.observable(e.conference),this.visible=ko.observable(!0),this.address=ko.observable(e.address)},appViewModel=function(){var e=this;this.query=ko.observable(""),this.teamList=ko.observableArray([]),this.liveSearch=function(t){e.teamList().forEach(function(t){t.name().toLowerCase().indexOf(e.query().toLowerCase())>=0?(t.visible(!0),t.marker.setVisible(!0)):(t.visible(!1),t.marker.setVisible(!1))})},this.createTeamList=function(){for(var t=0;t<teamData.length;t++)e.teamList.push(new Teams(teamData[t]))},this.filter=function(t){for(var a=0;a<teamData.length;a++)teamData[a].conference===t&&e.teamList.push(new Teams(teamData[a]));e.createMarker()},this.filterWest=function(){e.removeMarker(),e.teamList.removeAll(),e.query(""),e.filter("west")},this.filterEast=function(){e.removeMarker(),e.teamList.removeAll(),e.query(""),e.filter("east")},this.filterAll=function(){e.removeMarker(),e.teamList.removeAll(),e.query(""),e.createTeamList(),e.createMarker()},this.createMarker=function(){for(var t=0;t<e.teamList().length;t++){var a=new google.maps.Marker({map:e.map,position:{lat:e.teamList()[t].lat(),lng:e.teamList()[t].lng()},title:e.teamList()[t].name(),stadium:e.teamList()[t].stadium(),capacity:e.teamList()[t].capacity(),animation:google.maps.Animation.DROP,address:teamData[t].address});a.addListener("click",function(){e.letsBounce(this),e.getGeocodeAddress(this)}),e.teamList()[t].marker=a}},this.removeMarker=function(){e.teamList().forEach(function(e){e.marker.setMap(null)})},this.letsBounce=function(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1400)},this.handleMarker=function(){e.letsBounce(this.marker),e.getGeocodeAddress(this.marker)},this.infowindow,this.populateInfoWindow=function(e,t){t.marker!=e&&(t.marker=e,t.setContent("<div>"+e.title+"</div><div>"+e.stadium+"</div><div>"+e.address+"</div><div>capacity: "+e.capacity+"</div><div>weather: "+e.weather+"</div><div>temperature: "+e.temp+'Celsius</div><img src="https://maps.googleapis.com/maps/api/staticmap?center='+e.position.lat()+","+e.position.lng()+'&zoom=16&size=200x200&maptype=hybrid&key=AIzaSyCKRKYTqc_igfzoYRi0-fgyKDm21AVU_yU" alt="" />'),t.open(map,e),t.addListener("closeclick",function(){t.setMarker=null}))},this.getGeocodeAddress=function(t){var a=t.position.lat(),i=t.position.lng();$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?latlng="+a+","+i+"&key=AIzaSyCKRKYTqc_igfzoYRi0-fgyKDm21AVU_yU",success:function(a){var i=a.results[0].formatted_address;t.address=i,e.getWeather(t)},error:function(){alert("Unable to reach GoogleMap Geocoding - please try again later")}})},this.getWeather=function(t){var a=t.position.lat(),i=t.position.lng();$.ajax({url:"http://api.openweathermap.org/data/2.5/weather?lat="+a+"&lon="+i+"&APPID=906ae1bd2537be3aefb269cb9a2f068a&units=metric",success:function(a){console.log(a),t.temp=a.main.temp,t.weather=a.weather[0].description,e.populateInfoWindow(t,e.infowindow)},error:function(){alert("Unable to reach Openweathermap.org - please try again later")}})},this.map,this.initMap=function(){var t={center:{lat:37.8,lng:-101.5},zoom:5,mapTypeControl:!1,streetViewControl:!1};e.map=new google.maps.Map(document.getElementById("map"),t),e.infowindow=new google.maps.InfoWindow},this.initMap(),this.createTeamList(),this.createMarker()},init=function(){ko.applyBindings(new appViewModel)};$(document).ready(function(){$("#sidebar-btn").on("click",function(){$("#sidebar").toggleClass("visible")})});